{"version":3,"names":["runOnJS","useAnimatedReaction","computedOffsetXValueWithAutoFillData","useOnProgressChange","opts","autoFillData","loop","offsetX","size","rawDataLength","onProgressChange","isFunc","value","_value","Math","max","min","absoluteProgress","abs"],"sources":["useOnProgressChange.ts"],"sourcesContent":["import type Animated from \"react-native-reanimated\";\nimport {\n  runOnJS,\n  useAnimatedReaction,\n} from \"react-native-reanimated\";\n\nimport type { TCarouselProps } from \"../types\";\nimport { computedOffsetXValueWithAutoFillData } from \"../utils/computed-with-auto-fill-data\";\n\nexport function useOnProgressChange(\n  opts: {\n    size: number\n    autoFillData: boolean\n    loop: boolean\n    offsetX: Animated.SharedValue<number>\n    rawDataLength: number\n  } & Pick<TCarouselProps, \"onProgressChange\">,\n) {\n  const { autoFillData, loop, offsetX, size, rawDataLength, onProgressChange }\n        = opts;\n\n  // remember `isFunc` here because we can't accurately check typeof\n  // from within useAnimatedReaction because its code has been workletized;\n  // the `onProgressChange` value will be typeof \"object\" from within\n  // the worklet code even if it's a function.\n  const isFunc = typeof onProgressChange === \"function\";\n\n  useAnimatedReaction(\n    () => offsetX.value,\n    (_value) => {\n      let value = computedOffsetXValueWithAutoFillData({\n        value: _value,\n        rawDataLength,\n        size,\n        autoFillData,\n        loop,\n      });\n\n      if (!loop) {\n        value = Math.max(\n          -((rawDataLength - 1) * size),\n          Math.min(value, 0),\n        );\n      }\n\n      let absoluteProgress = Math.abs(value / size);\n\n      if (value > 0)\n        absoluteProgress = rawDataLength - absoluteProgress;\n\n      if (onProgressChange) {\n        if (isFunc)\n          runOnJS(onProgressChange)(value, absoluteProgress);\n\n        else\n          onProgressChange.value = absoluteProgress;\n      }\n    },\n    [loop, autoFillData, rawDataLength, onProgressChange],\n  );\n}\n"],"mappings":"AACA,SACEA,OAAO,EACPC,mBAAmB,QACd,yBAAyB;AAGhC,SAASC,oCAAoC,QAAQ,uCAAuC;AAE5F,OAAO,SAASC,mBAAmBA,CACjCC,IAM4C,EAC5C;EACA,MAAM;IAAEC,YAAY;IAAEC,IAAI;IAAEC,OAAO;IAAEC,IAAI;IAAEC,aAAa;IAAEC;EAAiB,CAAC,GACpEN,IAAI;;EAEZ;EACA;EACA;EACA;EACA,MAAMO,MAAM,GAAG,OAAOD,gBAAgB,KAAK,UAAU;EAErDT,mBAAmB,CACjB,MAAMM,OAAO,CAACK,KAAK,EAClBC,MAAM,IAAK;IACV,IAAID,KAAK,GAAGV,oCAAoC,CAAC;MAC/CU,KAAK,EAAEC,MAAM;MACbJ,aAAa;MACbD,IAAI;MACJH,YAAY;MACZC;IACF,CAAC,CAAC;IAEF,IAAI,CAACA,IAAI,EAAE;MACTM,KAAK,GAAGE,IAAI,CAACC,GAAG,CACd,EAAE,CAACN,aAAa,GAAG,CAAC,IAAID,IAAI,CAAC,EAC7BM,IAAI,CAACE,GAAG,CAACJ,KAAK,EAAE,CAAC,CACnB,CAAC;IACH;IAEA,IAAIK,gBAAgB,GAAGH,IAAI,CAACI,GAAG,CAACN,KAAK,GAAGJ,IAAI,CAAC;IAE7C,IAAII,KAAK,GAAG,CAAC,EACXK,gBAAgB,GAAGR,aAAa,GAAGQ,gBAAgB;IAErD,IAAIP,gBAAgB,EAAE;MACpB,IAAIC,MAAM,EACRX,OAAO,CAACU,gBAAgB,CAAC,CAACE,KAAK,EAAEK,gBAAgB,CAAC,CAAC,KAGnDP,gBAAgB,CAACE,KAAK,GAAGK,gBAAgB;IAC7C;EACF,CAAC,EACD,CAACX,IAAI,EAAED,YAAY,EAAEI,aAAa,EAAEC,gBAAgB,CACtD,CAAC;AACH","ignoreList":[]}