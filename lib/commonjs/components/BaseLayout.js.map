{"version":3,"names":["_react","_interopRequireDefault","require","_reactNativeReanimated","_interopRequireWildcard","_useOffsetX","_store","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","BaseLayout","props","handlerOffset","index","children","visibleRanges","animationStyle","context","React","useContext","CTX","loop","dataLength","width","height","vertical","customConfig","mode","modeConfig","size","offsetXConfig","snapDirection","showLength","type","viewCount","x","useOffsetX","animationValue","useDerivedValue","value","animatedStyle","useAnimatedStyle","createElement","View","style","position","testID","exports"],"sources":["BaseLayout.tsx"],"sourcesContent":["import React from \"react\";\nimport type { ViewStyle } from \"react-native\";\nimport type { AnimatedStyleProp } from \"react-native-reanimated\";\nimport Animated, {\n  useAnimatedStyle,\n  useDerivedValue,\n} from \"react-native-reanimated\";\n\nimport type { IOpts } from \"../hooks/useOffsetX\";\nimport { useOffsetX } from \"../hooks/useOffsetX\";\nimport type { IVisibleRanges } from \"../hooks/useVisibleRanges\";\nimport type { ILayoutConfig } from \"../layouts/stack\";\nimport { CTX } from \"../store\";\n\nexport type TAnimationStyle = (value: number) => AnimatedStyleProp<ViewStyle>;\n\nexport const BaseLayout: React.FC<{\n  index: number\n  handlerOffset: Animated.SharedValue<number>\n  visibleRanges: IVisibleRanges\n  animationStyle: TAnimationStyle\n  children: (ctx: {\n    animationValue: Animated.SharedValue<number>\n  }) => React.ReactElement\n}> = (props) => {\n  const { handlerOffset, index, children, visibleRanges, animationStyle }\n    = props;\n\n  const context = React.useContext(CTX);\n  const {\n    props: {\n      loop,\n      dataLength,\n      width,\n      height,\n      vertical,\n      customConfig,\n      mode,\n      modeConfig,\n    },\n  } = context;\n  const size = vertical ? height : width;\n\n  let offsetXConfig: IOpts = {\n    handlerOffset,\n    index,\n    size,\n    dataLength,\n    loop,\n    ...(typeof customConfig === \"function\" ? customConfig() : {}),\n  };\n\n  if (mode === \"horizontal-stack\") {\n    const { snapDirection, showLength } = modeConfig as ILayoutConfig;\n\n    offsetXConfig = {\n      handlerOffset,\n      index,\n      size,\n      dataLength,\n      loop,\n      type: snapDirection === \"right\" ? \"negative\" : \"positive\",\n      viewCount: showLength,\n    };\n  }\n\n  const x = useOffsetX(offsetXConfig, visibleRanges);\n  const animationValue = useDerivedValue(() => x.value / size, [x, size]);\n  const animatedStyle = useAnimatedStyle(\n    () => {\n      return animationStyle(x.value / size);\n    },\n    [animationStyle],\n  );\n\n  return (\n    <Animated.View\n      style={[\n        {\n          width: width || \"100%\",\n          height: height || \"100%\",\n          position: \"absolute\",\n        },\n        animatedStyle,\n      ]}\n      /**\n       * We use this testID to know when the carousel item is ready to be tested in test.\n       * e.g.\n       *  The testID of first item will be changed to __CAROUSEL_ITEM_0_READY__ from __CAROUSEL_ITEM_0_NOT_READY__ when the item is ready.\n       * */\n      testID={`__CAROUSEL_ITEM_${index}__`}\n    >\n      {children({ animationValue })}\n    </Animated.View>\n  );\n};\n"],"mappings":"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","ignoreList":[]}